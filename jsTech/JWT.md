Q .JWT 란?

```
JWT는 JSON 형식의 토큰입니다. 주로 사용자의 인증 또는 인가 정보를 서버와 클라이언트 간에 안전하게 주고받기 위해 사용됩니다.

JWT가 등장하기 전에는 웹에서 쿠키와 세션을 이용했는데 서버 단에 로그인한 모든 사용자의 세션을 DB나 캐시에 저장해놓고
쿠키로 넘어온 ID로 사용자 데이터를 매번 조회해야 해 비용이 많이드는 작업이었습니다.

JWT가 등장하기 전에는 주로 세션 기반 인증방식이 사용되었습니다. 세션 기반 인증 방식에서는 서버에 세션 정보를 저장해야 했습니다.
이는 곧 필요한 리소스 메모리 또는 데이터베이스가 추가로 필요함을 의미합니다. 그러나 JWT가 등장하면서 토큰 자체에 인증정보를 포함하기 때문에
별도의 세션 저장소가 필요하지 않아 세션 기반 인증방식의 단점을 보완해줄 수 있습니다.

그러나 이런 JWT에도 단점이 있습니다. JWT 토큰 자체에 모든 정보를 포함하고 서명을 사용하여 검증하기 때문에
토큰을 훔쳐서 사용하는 경우에 위조와 악용의 가능성이 존재합니다.

이러한 단점을 보완해주기 위해 토큰을 안전하게 전송하고 저장하는 것이 중요합니다.
```

Q. 안전하게 토큰을 보관하는 방법에는 무엇이 있는가?

```
우선 로컬스토리지와 쿠키에 저장하는 방법이 있는데 각 저장소의 장점과 단점에 대해 말씀드리겠습니다.

로컬스토리지에 저장하게 되었을 경우의 장점은 우선 간편하게 사용이 가능하다는 것입니다.
js를 사용하여 쉽게 접근하고 조작할 수 있고 클라이언트 측에서 직접 관리가 되어 인증을 처리할 수 있게됩니다.
이로 인해 서버와의 통신 횟수가 감소하고 성능을 향상시킬 수 있습니다.

그러나 JS로 쉽게 접근하고 조작이가능한 특성이 단점이 되기도 합니다. 악의적인 코드가 삽입되거나 XSS공격을 당할경우
토큰 정보가 노출되어 보안에 취약한 상황을 초래할 수 있습니다.

쿠키의 경우 httpOnly 속성을 이용하면 JS를 통한 접근이 불가능합니다. 이는 XSS공격에 대한 보안을 강화할 수 있음을 의미합니다.
그러나 쿠키의 경우 4kb의 작은 저장공간으로 인해 큰 용량의 정보를 저장하기에는 적절한 저장소가 아닐 수 있습니다.

따라서 가장 좋은 방법으로는 refresh token을 사용하는 방법이 있습니다.
refresh token은 access token이 만료되었을 때 갱신할 수 잇는 토큰으로 보통 access token보다 유효기간을 길게 설정해줍니다.
먼저 백엔드 개발자와 협업하여 로그인시 access token과 refresh token을 동시에 발급받을 수 있게 설정합니다.
이때 refresh token은 httpOnly 속성을 이용하여 쿠키에 안전하게 저장하고 access token은 js private 변수에 안전하게 저장합니다.
만약 access token의 유효기간이 만료되거나 페이지 이동으로 사라진다면 재발급을 요청하는데 이때 refresh token으로 서버와 통신하게 되고
서버는 refresh token의 유효성을 체크하고 새로운 Access token을 발급해줍니다. 그렇게 새로 발급받은 토큰이 다시 프라이빗 변수에 저장이됩니다.

정리하자면 서버와 통신하는 refresh token은 httpOnly 속성을 이용하여 쿠키에 저장되므로 XSS공격으로 부터 안전하고
access token은 js 프라이빗 변수에 저장하여 외부로부터 안전하게 보관되어 localstorage나 쿠키에 토큰을 저장하는 것보다는
안전하게 토큰을 관리할 수 있습니다.
```
